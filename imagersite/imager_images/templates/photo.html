{% extends "base.html" %}

{% block content %}

<style>
#photo-container
{
    position: relative;
    text-align: center;
}

#photo-container img
{
    width: 600px;
    float: left;
}

.facelabel
{
    position: absolute;
    cursor: pointer;
    text-align: left;
}

.facelabel .border
{
    border: solid 4px #FFFF00;
}

.facelabel .name
{
    display: inline-block;
    margin-top: 5px;
    font-size: 12px;
    padding: 6px;
    color: #444;
    background-color: #FFFF00
}

.delete-btn
{
    position: absolute;
    right: 0px;
    bottom: -20px;
    font-size: 12px;
}
</style>







<script type="text/javascript" src="//code.jquery.com/jquery-2.1.4.min.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js"></script>
<script type="text/javascript" src="//algorithmia.com/v1/clients/js/algorithmia-0.2.0.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/sweetalert/1.0.1/sweetalert-dev.js"></script>

 <script src="{{ MEDIA_URL }}facetagger.js" type="text/javascript"></script>
<body>
<h1>{{ photo.title }}</h1>
    <div >
    <h6 class='text-center'>Uploaded on {{ photo.date_uploaded }} -- {{photo.privacy }}</h6>
    <pre class='text-center'>{{ photo.description }}</pre>
    </div>
    <div id='photo-container'>
        <img src="{{ MEDIA_URL }}{{ photo.file }}">
    </div>
    </div>
    <form action="{% url 'photo' photo.id %}" method="post">
    {% csrf_token %}
    <input type="submit" value="Detect Faces" />

    <script type="text/javascript">
         $(document).ready(function(){
            FaceTagger.init({
                container: "#photo-container",
                labelUrl: "{{photo.id}}/faces",
                csrf: "{{ csrf_token }}",
                originalWidth: 852,
                originalHeight: 480,
                newWidth: $("#photo-container img").width(),
                newHeight: $("#photo-container img").height()
            });
        {% for f in faces %}
            var face = {
                id: {{f.id}},
                name: "{{f.name}}",
                x: {{f.x}},
                y: {{f.y}},
                width: {{f.width}},
                height: {{f.height}}
            };
            FaceTagger.make(face);
        {% endfor %}});
    </script>
</form>
</body>

{% endblock %}